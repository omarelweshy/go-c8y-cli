# yaml-language-server: $schema=https://raw.githubusercontent.com/reubenmiller/go-c8y-cli/feat/extensions-manager/tools/schema/extensionCommands.json
---
group:
  name: features
  description: Example features

commands:
  - name: preset-query-inventory-default
    description: Use query-inventory preset
    preset:
      type: query-inventory

  - name: preset-query-inventory-device
    description: List devices with custom query
    preset:
      type: query-inventory
      options:
        param: q
        value: (type eq '*')

  - name: preset-query-inventory-mo
    description: List devices with custom query
    preset:
      type: query-inventory
      options:
        param: query
        value: (type eq '*')
  
  - name: preset-get-identity-default
    description: Get identity
    preset:
      type: get-identity
      options:
        value: my_Type

  - name: idslices
    path: inventory/managedObjects
    description: Slices
    method: POST
    body:
      - name: id
        type: id[]
        description: id

  - name: lookup
    path: inventory/managedObjects
    description: Device group
    method: POST
    body:
      - name: application
        type: application
        description: application

      - name: applicationname
        type: applicationname
        description: applicationname

      - name: devicegroup
        type: devicegroup[]
        description: devicegroup
      
      - name: agent
        type: agent[]
        description: agent

      - name: device
        type: device[]
        description: device

      - name: deviceprofile
        type: deviceprofile[]
        description: deviceprofile

      - name: tenantname
        type: tenantname
        description: tenantname
      
      - name: role
        type: role[]
        description: role

      - name: roleself
        type: roleself[]
        description: roleself

      - name: source
        type: source
        description: source

  - name: completion
    path: application/applications/{id}
    method: GET
    description: Get application
    pathParameters:
      - name: id
        type: string
        description: Application lookup
        completion:
          type: external
          command:
            - c8y
            - applications
            - list
            - --pageSize=100
            - --type=MICROSERVICE
            - --filter
            - name like %s*
            - --select=name,type,id

        lookup:
          type: external
          command:
            - c8y
            - applications
            - list
            - --pageSize=100
            - --type=MICROSERVICE
            - --filter
            - name like %s*
            - --select=id

  - name: completion2
    path: inventory/managedObjects
    method: GET
    description: Get device collection
    queryParameters:
      - name: type
        type: string
        description: Device lookup with custom completions
        completion:
          type: external
          command:
            - pwsh
            - -c
            - c8y devices list -p 100 --query "has(enercon_Scada) and type eq 'WEC*'" --select type -o csv | sort | uniq

  - name: applications
    description: application lookups
    path: inventory/managedObjects
    method: POST
    body:
      - name: id
        type: microservice
        description: Microservice

      - name: instance
        type: microserviceinstance
        description: Microservice instance

  - name: devicerequests
    description: application lookups
    path: inventory/managedObjects
    method: POST
    body:
      - name: id
        type: devicerequest[]
        description: device request

  - name: user
    description: user lookups
    path: inventory/managedObjects
    method: POST
    body:
      - name: user
        type: user[]
        description: user

      - name: userself
        type: userself[]
        description: User self

      - name: usergroup
        type: usergroup[]
        description: Usergroup
